{% extends 'base.html.twig' %}

{% block title %}R√©clamation{% endblock %}

{% block body %}
    <h1>üìã D√©tails de la R√©clamation</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ reclamation.id }}</td>
            </tr>
            <tr>
                <th>UserId</th>
                <td>{{ reclamation.userId }}</td>
            </tr>
            <tr>
                <th>Description</th>
                <td>{{ reclamation.description }}</td>
            </tr>
            <tr>
                <th>MissionId</th>
                <td>{{ reclamation.missionId }}</td>
            </tr>
            <tr>
                <th>Status</th>
                <td>{{ reclamation.status }}</td>
            </tr>
            <tr>
                <th>Date</th>
                <td>{{ reclamation.date ? reclamation.date|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>Titre</th>
                <td>{{ reclamation.titre }}</td>
            </tr>
            <tr>
                <th>Nombre de r√©ponses</th>
                <td>
                    {{ reclamation.nombreReponses }}
                    <button class="btn btn-sm btn-info ms-2" onclick="toggleReponses()">üëÅÔ∏è Voir les r√©ponses</button>
                </td>
            </tr>
        </tbody>
    </table>

    <a href="{{ path('app_reclamation_index') }}" class="btn btn-secondary">‚¨Ö Retour √† la liste</a>
    <a href="{{ path('app_reclamation_edit', {'id': reclamation.id}) }}" class="btn btn-warning">‚úèÔ∏è Modifier</a>
    {{ include('reclamation/_delete_form.html.twig') }}

    <div id="reponses-list" style="display: none;" class="mt-4">
        <h2>üì© R√©ponses associ√©es</h2>

        <a href="{{ path('app_reponse_new', {'reclamationId': reclamation.id}) }}" class="btn btn-success mb-3">‚ûï Ajouter une r√©ponse</a>

        {% if reclamation.reponses is not empty %}
            <ul class="list-group">
                {% for reponse in reclamation.reponses %}
                    <li class="list-group-item">
                        <strong>Date :</strong> {{ reponse.dateCreation ? reponse.dateCreation|date('Y-m-d H:i') : 'Non d√©finie' }}<br>
                        <strong>Contenu :</strong> {{ reponse.contenu }}<br>
                        <strong>User ID :</strong> {{ reponse.userId }}<br>

                        <div class="mt-2">
                            <a href="{{ path('app_reponse_edit', {'id': reponse.id}) }}" class="btn btn-sm btn-warning">‚úèÔ∏è Modifier</a>

                            {{ include('reponse/_delete_form.html.twig', {'reponse': reponse}) }}
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Aucune r√©ponse pour cette r√©clamation.</p>
        {% endif %}
    </div>

    <script>
        function toggleReponses() {
            const div = document.getElementById('reponses-list');
            div.style.display = div.style.display === 'none' ? 'block' : 'none';
        }
    </script>
{% endblock %}
